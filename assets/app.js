function get_short_url(e){var r=document.getElementById("url").value,t=document.getElementById("preferred_short_url").value,n={url:r};""!=t&&(n.preferred_short_url=t);send_api_request(api_domain+"api",n,function(e){var r=short_url_from_api_return(e),t=document.getElementById("response-data"),n=create_short_url_link(api_domain,r,"response-link");t.appendChild(n),display_response(),add_data_to_copy("url-copy-button",api_domain+r)})}function send_api_request(e,r,t){console.log(r);var n;if(!window.XMLHttpRequest)return!1;n=new XMLHttpRequest,n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.responseText)};var o=r.url,a=r.preferred_short_url,u=e+"/?url="+o;if(a){var d=r.preferred_short_url;u+="&preferred_short_url="+d}n.open("GET",u,!0),n.send()}function create_short_url_link(e,r,t){var n=document.createElement("a");return n.href=e+r,n.id=t,n.innerHTML=e+r,n}function short_url_from_api_return(e){return e=JSON.parse(e),e.short_url}function add_data_to_copy(e,r){var t=document.getElementById(e);t.setAttribute("data-clipboard-text",r);var n=new ZeroClipboard(t);n.on("aftercopy",function(e){t.innerHTML="Copied"})}function display_ui(){var e=document.getElementById("response-wrapper"),r=document.getElementById("ui-wrapper");r.className="",e.className="hidden"}function display_response(){var e=document.getElementById("response-wrapper"),r=document.getElementById("ui-wrapper");r.className="hidden",e.className=""}function show_clipboard_prompt(e){}var get_short_url_action=document.getElementById("shorten-action");get_short_url_action.addEventListener("click",function(){get_short_url()});